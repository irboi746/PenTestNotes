# Network Recon
## Information Gathering 

#### Onilne Tools
1. DNS Dumpster    
   * Online tool to do DNS information gathering.
2. Foca & Shodan

#### Offline Tools
1. DNSEnum
   * A command line tools that get's host address, get name servers, get mx records, perform zone transfer queries, bruteforce subdomains
2. DNSmap
   * DNS enumeration bruteforce tool
## Host Discovery
* Objective of Host discovery is to findout the hosts that are online to move on with the next step.

### Tools
1. Fping
   * `fping -a -g <ip address block>` 
      * `-a` shows alive host  
      * `-g` generate a target list from supplied IP netmask

2. Hping
3. Nmap

## Scanning 
* Objective of Scanning is to map the network within the scope of engagement and find out the Port, Protocols and Services that are running on each host.

### Tools
1. HPING / NPING
   * allow us to craft packets for host detection, porst scan and evade firewall.
   #### HPING to conduct Idle Scan
   * 2 Criteria for zombie host are **IP ID are assigned incrementally and globally** and **zombie that does not send or receive and packets so as to not disturb the IP ID**
   1. Find open port on host
   2. Identify if host can be a Zombie Host
      * `hping3 -S -r -p <port> <ip address>`
      * Look at *id* column, if it increments by one it means that host does not send or receive other communications 
   3. Using hping to craft packets  
      * `hping3 -a <ip of zombie> -S -p <target port> <target IP address>` 
   4. Detecting open port
      * `hping3 -S -r -p <zombie port> <zombie>`
      * if output of IP ID is +2, we can deduce that the *target port* and *target ip address is open*
      
2.  NMAP
   #### Standard NMAP Scan
   * **Half SYN Scan** `nmap -sS -p <port range> <ip address> 
   * **Full SYN Scan** `nmap -sT -p <port range> <ip address>`
   * **UDP Scan** `nmap -sU -p <port range> <ip address> `

   #### Stealth Methods
   * **Idle Scan** `nmap -Pn -sI <ip address zombie>:<open port on zombie> <ip address target> -v`
     * Pre-requisite  
        1. a zombie that assigns IP ID both incrementally and globally
        2. zombie that does not send or receive and packets so as to not disturb the IP ID.
     * How it works is [here](https://nmap.org/book/idlescan.html)
   #### Stealth Operators
   * **Never do DNS resolution** `mnap <ip address> -n`
      * use whenever DNS resolution is not needed to keep more stealthy and reduce scan time. 
   * **FTP bounce scan** `mnap <ip address> -b`
      *  If FTP server is vulnerable, exploits FTP servers 'PORT' command to launch port scan from FTP server
      *  Detailed explanation [here](https://nmap.org/book/scan-methods-ftp-bounce-scan.html) 
      *  Scans using this method will appear on the network to have originated from FTP server.  
   * **NULL, FIN, Xmas Scans** `-sN, -sF, -sX`
      * Explotis the TCP RFC page 65 to differentiate open ports from closed ports.
      * Hence compliant systems will return a RST if port is closed and not respond when port is opened.
      * Details [here](https://nmap.org/book/scan-methods-null-fin-xmas-scan.html) 
   #### Firewall Ruleset Enum 
   * **TCP ACK Scan** `nmap -sA <ip address>`
      * used to map the rulesets of firewalls and determine if the devices are both stateful and which ports are filtered.
      * Ports that return RST packets will be marked unfiltered while ports that do not repsond will be marked filtered.
   #### Protocol Enum 
   * **TCP Protocol Scan** `nmap -sO -p<port range> <ip address>`
      * enumerates the types of IP protocols that the target system supports.
   #### Output
   * **Normal Output** `-oN <filename>`
   * **XML output** `-oX <filename>`
### References : 
[NMAP vs MASSSCAN](https://capt-meelo.github.io//pentest/2019/07/29/port-scanning.html)
