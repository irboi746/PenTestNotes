# Table of Content
- [HTTP Protocol](#http-protocol)
- [HTTP Header](#http-header)
  * [Request](#request)
  * [Response](#response)
- [HTTPS](#https)
- [Web Encoding](#web-encoding)
- [Same Origin Policy](#same-origin-policy)
- [Cookies & Sessions](#cookies-and-sessions)
  * [Cookies](#cookies)
  * [Session](#session)
  * [Session Cookie](#session-cookie)
- [Web Application Proxies](#web-application-proxies)
- [SQL 101](#SQL-101)
# HTTP Protocol
* HTTP Protocol is a protocol for web browsing.
* It uses a client-server protocol to transfer web pages or web application data. 
   1. The client will use a **web browser** to start a connection with a **web server**.  
   2. After connection is established, client will communicate with server via a **request**
   3. The server will then reply with a **reponse** and the content requested by the client. 

# HTTP Header
* As mentioned above, there are in general two types of HTTP headers **REQUEST** and **RESPONSE**
* Below will be the analysis of each of the respective headers.
## Request
![HTTP_Req](https://github.com/irboi746/PenTestNotes/blob/main/Fundamentals/Resources/HTTPReq.JPG)
### "GET / HTTP/1.1"
1. *GET* - is the default **request method**. There are other methods(VERBS) like POST, PUT, DELETE, OPTIONS, TRACE etc.  
2. '/' - is the path of the file that is requested. In this case, "*/*" refers to the homepage. 
3. *HTTP/1.1* - is the HTTP protocol version the browser wants to communicate in. It informs the server which version of HTTP to use in the communication 
### Host:(value) 
* One Webserver instance(one IP address) can host multiple websites. **Host** header specifies the website that is to be requested.
* Host value + Path will create the full URL  
### User-Agent:(value)
* User-Agent reveals the browser version, operating system and language to the web server.
### Accept:(value) 
* **Accept** header is used by browser to specify which document type is expected to be returned in the response.
* In this case, a html is expected to be returned.   
### Accept-Encoding:(value) 
* Similar to **Accept**, **Accept-Encoding** specifies the allowed content encoding to be returned in the reponse.  
### Connection:(value)
* This header is to specify the connection type to the web server (closed/keep-alive) 
* In this context, *keep-alive* indicates that the client would like to keep the connection open.
* HTTP/2 or HTTP 2.0 does not have connection-specific header fields.
    
## Response
![HTTP_Res](https://github.com/irboi746/PenTestNotes/blob/main/Fundamentals/Resources/HTTPRes.JPG)
### Status Line
* This is the first line of a response message.
* It contains the (Protocol Version) (Status Code) (Relative Textual Meaning of Status Code)
* Hence in this case, HTTP1.1 is the protocol version used, 200 is the status code and OK.
* Common Status Codes : 
    * 200 OK - Resource Found
    * 301 Moved Permanently - Requested Resource has been assigned to new permanent URI
    * 302 Found - Resource is temporarily under another URI
    * 403 Forbidden - Client does not have enough privileges and server refuses to fulfil the request
    * 404 Not Found - server cannot find the resource matching the request
    * 500 Internal Server Error - server does not support the functionality required to fulfil the request
    * More codes found [here](https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)
### Date 
represents the date and time at which the reponse message originated
### Cache-Control
allows the client browser and server to agree about caching rules to save bandwidth.
### Content-Type
lets the client know how to intepret the page content
### Content-Encoding
tells the client the type of encoding used for the content
### Server
This header displays the banner of the web server.
### Content-Length
Indicates the length (in bytes) of the message. 

# HTTPS
* HTTP is a clear-text protocol and by itself does not provide strong authentication between two communicating parties, therefore it can be easily intercepted or manipulated by an attacker.
* HTTPS (HTTP Secure) or HTTP over TLS/SSl is a method where HTTP protocol is runned on a cryptographic protocol(TLS/SSL).
* HTTPS protects the data exchanged between the client and the server.
* HTTPS can secure the HTTP Protocol from basic passive packet sniffing, MiTM attacks as well as verify the web server through the digital certificates.
* However, HTTPS does not protect against web application flaws like XSS and SQLi.
* Additionally, there are attacks like SSL stripping, phishing websites, carefully crafted MiTM etc where attackers can also bypass HTTPS.

# Web Encoding
* These are various common encoding method for web communication : 
   * [ASCII](https://www.ascii-code.com/)
   * [Unicode](https://unicode-table.com/en/#0032)
   * Base64
   * If not defined in the HTTP Header, the default encoding used will be the ISO-8859-1(Latin-1) 
* HTML Entities
   * HTML language contains many characters with special meanings like "<>"
   * a string that starts with '&' or '&#' and ends with ';' is used so that the browser will not intepret these symbols as a HTML language element.
   * Although not intended as a security feature, HTML entities can help prevent many client side attacks like XSS.
* [URL Encoding](https://www.w3schools.com/tags/ref_urlencode.asp)
   * URl sent over the internet must contain characters within the ASCII code set. 
   * Hence there are characters that cannot be represented over the URL and encoding is required. 
   * URLs use some characters for special purposes in defining their syntax, these are called reserved characters e.g : **! @ # $ % & * = + : / ? , ; : " )( ] \[**
   * When these characters are not used in their special role inside a URL, they need to be encoded. 
   * Again URL encode is not an intended security feature but it is able to help make the attack surface smaller. 

# Same Origin Policy
Reference : (https://en.wikipedia.org/wiki/Same-origin_policy)
* Same origin Policy(SOP) is a a web browser isolation policy that permits scripts contained in a first web page to access data in a second web page, only if both web pages have the same origin.
* An origin is defined as a combination of protocol, URI scheme, host name, and port number. 
* This policy prevents a malicious script on one page from obtaining access to sensitive data on another web page through that page's Document Object Model.
* Internet Explorer have two exceptions to this Same Origin Policy : 
   1. Port : IE does not consider the port as a component of SOP
   2. Trust Zone : SOP does not apply to domains that are in "highly trusted zone"
* SOP Exceptions : 
   1. window.location
   2. document.domain
   3. Cross Window Messaging
   4. Cross Origin Resource Sharing (CORS)

# Cookies and Sessions
* HTTP is a stateless protocol as such cookies and sessions are needed to make HTTP stateful.
## Cookies
* Cookies are small pieces of textual information installed in the cache of the web browser by the web-server.  
* Cookies are set in the browser cache via the **Set-Cookie** HTTP header field in the response message.
* Cookies come in name-value pair.
* Format of HTTP Cookie : 
   1. Domain : 
      * represents the domain value for which cookie is valid 
      * Any subsequent request with the same domain established will be sent together with this cookie. 
      * There are three types of cookie domain setting namely, Specified Cookie Domain, Unspecified Cookie Domain.
      * Internet Explorer has special exceptions to cookie domain settings too.
      *  more details are explained below (Cookie Domains Settings)
   2. Expires
      * expiration time of the cookie. Cookie will only be sent to the server if it has not expired.
      * Session cookies expires when session exits.
   3. Path
      * thsi field specifies the path in which the browser needs to send the cookies to.
      * for instance cookies with path *= /downloads*, all subsequent request to */downloads* will include this cookie. Browser will not send this cookie for requests to other paths e.g */shop*, */members* etc
   4. Content
      * this is the part where content is set in key-value pairs such as *username='abc'*, *authentication='0'*
      * server can set multiple values at once
   5. HttpOnly FLAG
      * this flag is used to force the browser to send the cookies only through HTTP.
      * This flag prevents cookie from being read via Javascript, Flash or any non-HTML technology.
      * It is a protection mechanism against XSS.
   6. SECURE FLAG 
      * this flag forces the browser to send cookies only thourgh HTTPS. 
      * Thus preventing cookie sniffing.

### Cookie Domain Settings
1. Specified Cookie Domain
   * There are two cases where the browser will send a cookie with domain value specified : 
     1. cookie domain value = target domain (e.g domain value = example.com and page requested is example.com/index/php)
     2. cookie domain value is a suffix of target domain (e.g domain value = example.com, page requested is aa.example.com)
   * Another rule here is that a lower level subdomain can set cookies for higher domain (e.g a.example.com can set a cookie for a.example.com as well as example.com) but higher domain cannot set cookies for lower level subdomains (e.g example.com cannot set cookies for a.example.com).
   
2. Unspecified Cookie Domain
   * if the server does not specify domain attribute, the browser will automatically set the domain as the server domain and set the cookie's host-only flag therefore the cookie will be sent only to the precise hostname.
   * e.g Therefore Browser will only match HTTP requests that exactly matches the following format : *http\[s]://example.com/\**
   
3. Internet Explorer Exception
   * Internet explorer does not distinguish between cookies with specified domain and unspecified domain.
   * Cookies without specified domain will be interpreted by Internet Explorer as if they had a specified domain, with domain value corresponding to the target domain set in it.
   * Therefore the following matches are accepted *\*.example.com*, *example.com/\** 

## Session
* HTTP sessions is a simple mechanism that allows web servers to store variables specific for given visit on the server.
* This is to hide application logic or avoid back and forth data transmission.
* Cookies are stored on the client, while sessions are stored on the server.
* Session cookies are stored as a single parameter, formatted in a key-value pair
* Concept of Session : 
   1. *Session ID* or *token* is assigned to the client by the web server
   2. client will present *Session ID* or *token* for each subsequent request 
   3. Server will retrieve both the state of the client and all of its associated variables.
* Default token names : 
   * PHPSESSID=(value) --> website running PHP 
   * JSESSIONID=(value) --> website running JSP (Java)
## Session Cookie
* Session Cookie is a combination of both session and cookies
* This is commonly seen in login pages/authentication:
  1. Browser will send a HTTP Request with POST verb that carries the user's credentials
  2. Server then sends a HTTP RESPONSE with an appropriate Set-Cookie header that also contains sessionID in the content field.
  3. Subsequent communication will then make use of the session cookie within the HTTP Request.

# Web Application Proxies
* Intercepting Proxies are tools that allows one to analyse and modify request and response between HTTP client and Server.
* It is commonly used to understand, analyse and exploit web application behaviours.
* Intercepting Proxies are not to be confused with Web Proxies (Proxy Servers)
* Common Proxies used in Pentest
   * Burp Suite
   * OWASP ZAP  
# SQL 101
Reference : https://www.w3schools.com/sql/sql_intro.asp
* Complex Web Applications generally use a database for storing data such as user credentials, statistics.
* To interact with databases, Structured Quert Language(SQL) is used.
* SQL is an interpreted language used to extract and manipulate data from a database.
* Connection to the database and queries (SQL Commands) are embedded on the server side code of the web application
* To get to the database, web application would send a GET request to request the resource with a parameter. Hence on the server it would look like this : `SELECT <parameter from GET> FROM table ...`  

## SQL Basics
* Basic SELECT QUERY \
`SELECT <column list> FROM <table> WHERE <condition>`
* aaa \
`aaa`
* 
